import{b as W,i as B,a as J,u as A,k as X,w as Q}from"./ResizeObserver.es.c9f0dcad.js";import{d as R,M as ee,h as n,g as k,an as ae,a8 as Y,U as D,o as C,b as O,w as Z,a5 as le,k as P,n as L,l as g,N as U,a6 as te,T as se,ab as oe,c as q,H as V,F as re,Z as ne,as as ie,x as I,a9 as ue,O as F,j as ce,B as ve,r as me,I as fe,e as de,ah as pe}from"./framework.ae1e5339.js";import{t as he}from"./error.0397081d.js";const ye=W({height:{type:[String,Number],default:""},maxHeight:{type:[String,Number],default:""},native:{type:Boolean,default:!1},wrapStyle:{type:J([String,Object,Array]),default:""},wrapClass:{type:[String,Array],default:""},viewClass:{type:[String,Array],default:""},viewStyle:{type:[String,Array,Object],default:""},noresize:Boolean,tag:{type:String,default:"div"},always:Boolean,minSize:{type:Number,default:20}}),we={scroll:({scrollTop:m,scrollLeft:i})=>[m,i].every(B)},b=4,ge={vertical:{offset:"offsetHeight",scroll:"scrollTop",scrollSize:"scrollHeight",size:"height",key:"vertical",axis:"Y",client:"clientY",direction:"top"},horizontal:{offset:"offsetWidth",scroll:"scrollLeft",scrollSize:"scrollWidth",size:"width",key:"horizontal",axis:"X",client:"clientX",direction:"left"}},be=({move:m,size:i,bar:o})=>({[o.size]:i,transform:`translate${o.axis}(${m}%)`}),G=Symbol("scrollbarContextKey"),Se=W({vertical:Boolean,size:String,move:Number,ratio:{type:Number,required:!0},always:Boolean}),ze="Thumb",K=R({__name:"thumb",props:Se,setup(m){const i=m,o=ee(G),s=A("scrollbar"),h=A("scrollbar-fade");o||he(ze,"can not inject scrollbar context");const l=n(),u=n(),v=n({}),d=n(!1);let t=!1,S=!1,y=oe?document.onselectstart:null;const a=k(()=>ge[i.vertical?"vertical":"horizontal"]),z=k(()=>be({size:i.size,move:i.move,bar:a.value})),x=k(()=>l.value[a.value.offset]**2/o.wrapElement[a.value.scrollSize]/i.ratio/u.value[a.value.offset]),N=e=>{var r;if(e.stopPropagation(),e.ctrlKey||[1,2].includes(e.button))return;(r=window.getSelection())==null||r.removeAllRanges(),$(e);const c=e.currentTarget;c&&(v.value[a.value.axis]=c[a.value.offset]-(e[a.value.client]-c.getBoundingClientRect()[a.value.direction]))},_=e=>{if(!u.value||!l.value||!o.wrapElement)return;const r=Math.abs(e.target.getBoundingClientRect()[a.value.direction]-e[a.value.client]),c=u.value[a.value.offset]/2,p=(r-c)*100*x.value/l.value[a.value.offset];o.wrapElement[a.value.scroll]=p*o.wrapElement[a.value.scrollSize]/100},$=e=>{e.stopImmediatePropagation(),t=!0,document.addEventListener("mousemove",T),document.addEventListener("mouseup",E),y=document.onselectstart,document.onselectstart=()=>!1},T=e=>{if(!l.value||!u.value||t===!1)return;const r=v.value[a.value.axis];if(!r)return;const c=(l.value.getBoundingClientRect()[a.value.direction]-e[a.value.client])*-1,p=u.value[a.value.offset]-r,w=(c-p)*100*x.value/l.value[a.value.offset];o.wrapElement[a.value.scroll]=w*o.wrapElement[a.value.scrollSize]/100},E=()=>{t=!1,v.value[a.value.axis]=0,document.removeEventListener("mousemove",T),document.removeEventListener("mouseup",E),f(),S&&(d.value=!1)},M=()=>{S=!1,d.value=!!i.size},j=()=>{S=!0,d.value=t};ae(()=>{f(),document.removeEventListener("mouseup",E)});const f=()=>{document.onselectstart!==y&&(document.onselectstart=y)};return Y(D(o,"scrollbarElement"),"mousemove",M),Y(D(o,"scrollbarElement"),"mouseleave",j),(e,r)=>(C(),O(se,{name:g(h).b()},{default:Z(()=>[le(P("div",{ref_key:"instance",ref:l,class:L([g(s).e("bar"),g(s).is(a.value.key)]),onMousedown:_},[P("div",{ref_key:"thumb",ref:u,class:L(g(s).e("thumb")),style:U(z.value),onMousedown:N},null,38)],34),[[te,e.always||d.value]])]),_:1},8,["name"]))}}),xe=W({always:{type:Boolean,default:!0},width:String,height:String,ratioX:{type:Number,default:1},ratioY:{type:Number,default:1}}),Te=R({__name:"bar",props:xe,setup(m,{expose:i}){const o=m,s=n(0),h=n(0);return i({handleScroll:l=>{if(l){const u=l.offsetHeight-b,v=l.offsetWidth-b;h.value=l.scrollTop*100/u*o.ratioY,s.value=l.scrollLeft*100/v*o.ratioX}}}),(l,u)=>(C(),q(re,null,[V(K,{move:s.value,ratio:l.ratioX,size:l.width,always:l.always},null,8,["move","ratio","size","always"]),V(K,{move:h.value,ratio:l.ratioY,size:l.height,vertical:"",always:l.always},null,8,["move","ratio","size","always"])],64))}});const Ee=R({name:"TuScrollbar"}),Be=R({...Ee,props:ye,emits:we,setup(m,{expose:i,emit:o}){const s=m,h=o;let l,u;const v=A("scrollbar"),d=n(),t=n(),S=n(),y=n("0"),a=n("0"),z=n(),x=n(1),N=n(1),_=k(()=>[s.wrapClass,v.e("wrap"),{[v.em("wrap","hidden-default")]:!s.native}]),$=k(()=>{const e={};return s.height&&(e.height=X(s.height)),s.maxHeight&&(e.maxHeight=X(s.maxHeight)),[s.wrapStyle,e]}),T=()=>{var e;t.value&&((e=z.value)==null||e.handleScroll(t.value),h("scroll",{scrollTop:t.value.scrollTop,scrollLeft:t.value.scrollLeft}))};function E(e,r){pe(e)?t.value.scrollTo(e):B(e)&&B(r)&&t.value.scrollTo(e,r)}const M=e=>{B(e)&&(t.value.scrollTop=e)},j=e=>{B(e)&&(t.value.scrollLeft=e)},f=()=>{if(!t.value)return;const e=t.value.offsetHeight-b,r=t.value.offsetWidth-b,c=e**2/t.value.scrollHeight,p=r**2/t.value.scrollWidth,w=Math.max(c,s.minSize),H=Math.max(p,s.minSize);x.value=c/(e-c)/(w/(e-w)),N.value=p/(r-p)/(H/(r-H)),a.value=w+b<e?`${w}px`:"",y.value=H+b<r?`${H}px`:""};return ne(G,ie({scrollbarElement:d,wrapElement:t})),I(()=>s.noresize,e=>{e?(l==null||l(),u==null||u()):({stop:l}=ue(S,f),u=Y("resize",f))},{immediate:!0}),I(()=>[s.maxHeight,s.height],()=>{s.native||F(()=>{var e;f(),t.value&&((e=z.value)==null||e.handleScroll(t.value))})}),ce(async()=>{s.native||(await F(),f())}),ve(()=>f()),i({wrapRef:t,update:f,scrollTo:E,setScrollTop:M,setScrollLeft:j,handleScroll:T}),(e,r)=>(C(),q("div",{ref_key:"scrollbarRef",ref:d,class:L(g(v).b())},[P("div",{ref_key:"wrapRef",ref:t,class:L(_.value),style:U($.value),onScroll:T},[(C(),O(fe(e.tag),{ref:"viewRef",class:L([g(v).e("view"),e.viewClass]),style:U(e.viewStyle)},{default:Z(()=>[me(e.$slots,"default")]),_:3},8,["class","style"])),e.native?de("",!0):(C(),O(Te,{key:0,ref_key:"barRef",ref:z,height:a.value,width:y.value,always:e.always,"ratio-x":N.value,"ratio-y":x.value},null,8,["height","width","always","ratio-x","ratio-y"]))],38)],2))}}),Ne=Q(Be);export{Ne as s};
