import{y as Ve,A as $e,B as _e,b as Be,c as Fe,a as ue,u as de,w as Me}from"./ResizeObserver.es.ec0808e4.js";import{g as u,a3 as Q,l as e,M as V,h as g,j as ye,x as he,U as Le,z as Te,O as pe,d as Ie,E as Re,a2 as je,at as P,a5 as ze,a6 as De,o as v,c as k,n as h,r as A,e as I,k as M,b,w as L,I as X,L as ce,F as Ke,H as Ae,a1 as Ue,t as ve}from"./framework.207eb8f6.js";import{i as me,V as Oe,f as T,c as Ge,v as He,h as We}from"./index.0f7a71d7.js";import{m as qe}from"./typescript.defaf979.js";import{d as be}from"./error.0397081d.js";function Je(t){return t==null}const Y="update:modelValue",ha="change",Ia="input",ba=["onFocus","onFocusin","onFocusout","onBlur","onChange","onBeforeinput","onInput","onReset","onSubmit","onInvalid","onKeydown","onKeypress","onKeyup","onCopy","onCut","onPaste","onCompositionstart","onCompositionupdate","onCompositionend","onSelect","autocomplete","autofocus","maxlength","minlength","name","pattern","readonly","required"],xe=t=>{const a=Q();return u(()=>{var d,p;return(p=(d=a==null?void 0:a.proxy)==null?void 0:d.$props)==null?void 0:p[t]})},fe={prefix:Math.floor(Math.random()*1e4),current:0},Xe=Symbol("elIdInjection"),Ye=()=>Q()?V(Xe,fe):fe,Qe=t=>{const a=Ye(),d=Ve();return u(()=>e(t)||`${d.value}-id-${a.prefix}-${a.current++}`)},Ze=["class","style"],ea=/^on[A-Z]/,aa=(t={})=>{const{excludeListeners:a=!1,excludeKeys:d}=t,p=u(()=>((d==null?void 0:d.value)||[]).concat(Ze)),o=Q();return o?u(()=>{var m;return $e(Object.entries((m=o.proxy)==null?void 0:m.$attrs).filter(([c])=>!p.value.includes(c)&&!(a&&ea.test(c))))}):u(()=>({}))},Z=Symbol("formContextKey"),we=Symbol("formItemContextKey"),ta=(t,a={})=>{const d=g(void 0),p=a.prop?d:xe("size"),o=a.global?d:_e(),m=a.form?{size:void 0}:V(Z,void 0),c=a.formItem?{size:void 0}:V(we,void 0);return u(()=>e(t)||p.value||(c==null?void 0:c.size)||(m==null?void 0:m.size)||o.value||"")},na=t=>{const a=xe("disabled"),d=V(Z,void 0);return u(()=>a.value||e(t)||(d==null?void 0:d.disabled)||!1)},ge=()=>{const t=V(Z,void 0),a=V(we,void 0);return{form:t,formItem:a}},oa=(t,{formItemContext:a,disableIdGeneration:d,disableIdManagement:p})=>{d||(d=g(!1)),p||(p=g(!1));const o=g();let m;const c=u(()=>{var l;return!!(!t.label&&a&&a.inputIds&&((l=a.inputIds)==null?void 0:l.length)<=1)});return ye(()=>{m=he([Le(t,"id"),d],([l,f])=>{const x=l??(f?void 0:Qe().value);x!==o.value&&(a!=null&&a.removeInputId&&(o.value&&a.removeInputId(o.value),!(p!=null&&p.value)&&!f&&x&&a.addInputId(x)),o.value=x)},{immediate:!0})}),Te(()=>{m&&m(),a!=null&&a.removeInputId&&o.value&&a.removeInputId(o.value)}),{isLabeledByFormItem:c,inputId:o}},la=Be({id:{type:String,default:void 0},size:Fe,disabled:Boolean,modelValue:{type:ue([String,Number,Object]),default:""},type:{type:String,default:"text"},autocomplete:{type:String,default:"off"},formatter:{type:Function},parser:{type:Function},placeholder:{type:String},form:{type:String},readonly:{type:Boolean,default:!1},allowClear:{type:Boolean,default:!1},showPassword:{type:Boolean,default:!1},showWordLimit:{type:Boolean,default:!1},suffixIcon:{type:me},prefixIcon:{type:me},containerRole:{type:String,default:void 0},label:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},validateEvent:{type:Boolean,default:!0},inputStyle:{type:ue([Object,Array,String]),default:()=>qe({})}}),sa={[Y]:t=>!0,input:t=>!0,change:t=>!0,focus:t=>!0,blur:t=>!0,clear:()=>!0,mouseleave:t=>!0,mouseenter:t=>!0,keydown:t=>!0,compositionstart:t=>!0,compositionupdate:t=>!0,compositionend:t=>!0};function ra(t,a,d){const p=g(!1),o=g(!1),m=g(!1),c=g(!1),l=u(()=>d.value),f=u(()=>Je(t.modelValue)?"":String(t.modelValue)),x=u(()=>f.value.length),{formItem:w}=ge(),C=async()=>{var n;await pe(),(n=l.value)==null||n.focus()},$=()=>{var n;return(n=l.value)==null?void 0:n.blur()},_=()=>{var n;return(n=l.value)==null?void 0:n.select()},U=()=>{a(Y,""),a("change",""),a("clear"),a("input","")},O=n=>{p.value=!0,a("mouseenter",n)},G=n=>{p.value=!1,a("mouseleave",n)},B=n=>{a("compositionstart",n),m.value=!0},R=n=>{a("compositionupdate",n)},j=n=>{a("compositionend",n),m.value&&(m.value=!1,N(n))},N=async n=>{let{value:y}=n.target;if(t.formatter&&(y=t.parser?t.parser(y):y),!m.value){if(y===f.value){E();return}a(Y,y),a("input",y),await pe(),E()}},S=n=>{o.value=!0,a("focus",n)},H=n=>{var y;o.value=!1,a("blur",n),t.validateEvent&&((y=w==null?void 0:w.validate)==null||y.call(w,"blur").catch(q=>be()))},W=n=>{a("change",n.target.value)},z=n=>{a("keydown",n)},D=()=>{c.value=!c.value,C()},E=()=>{const n=l.value,y=t.formatter?t.formatter(f.value):f.value;!n||n.value===y||(n.value=y)};return he(f,()=>E()),{inputRef:l,isHovering:p,isFocused:o,isPasswordVisible:c,nativeInputValue:f,textLength:x,focus:C,blur:$,select:_,clear:U,handleMouseEnter:O,handleMouseLeave:G,handleCompositionStart:B,handleCompositionUpdate:R,handleCompositionEnd:j,handleInput:N,handleFocus:S,handleBlur:H,handleChange:W,handleKeydown:z,handlePasswordVisible:D,setNativeInputValue:E}}const ia=["role"],ua=["id","type","disabled","formatter","parser","readonly","autocomplete","tabindex","aria-label","placeholder","form"],da=Ie({name:"TuInput",inheritAttrs:!1}),pa=Ie({...da,props:la,emits:sa,setup(t,{expose:a,emit:d}){const p=Re(),o=t,m=d,c=je(),l=de("input"),f=de("input-group"),x=ta(),w=na(),C=aa({excludeKeys:u(()=>Object.keys(ie.value))}),{form:$,formItem:_}=ge(),{inputId:U}=oa(o,{formItemContext:_}),{inputRef:O,isHovering:G,isFocused:B,isPasswordVisible:R,textLength:j,nativeInputValue:N,focus:S,blur:H,select:W,clear:z,handleMouseEnter:D,handleMouseLeave:E,handleCompositionStart:n,handleCompositionUpdate:y,handleCompositionEnd:q,handleInput:ee,handleFocus:ae,handleBlur:te,handleChange:ne,handleKeydown:oe,handlePasswordVisible:Ce,setNativeInputValue:Se}=ra(o,m,p),F=u(()=>(_==null?void 0:_.validateState)||""),le=u(()=>($==null?void 0:$.statusIcon)??!1),se=u(()=>F.value&&Oe[F.value]),Ee=u(()=>!!K.value&&j.value>Number(C.value.maxlength)),J=u(()=>o.allowClear&&!w.value&&!o.readonly&&!!N.value&&(B.value||G.value)),re=u(()=>o.showPassword&&!w.value&&!o.readonly&&!!N.value&&(!!N.value||B.value)),K=u(()=>o.showWordLimit&&!!C.value.maxlength&&o.type==="text"&&!w.value&&!o.readonly&&!o.showPassword),ke=u(()=>!!c.suffix||!!o.suffixIcon||J.value||o.showPassword||K.value||!!F.value&&le.value),Ne=u(()=>({[l.b()]:!0,[l.m(x.value)]:x.value,[l.is("disabled")]:w.value,[l.is("exceed")]:Ee.value,[f.b()]:c.prepend||c.append,[f.m("prepend")]:c.prepend,[f.m("append")]:c.append,[P().class]:P().class})),Pe=u(()=>[P().style,o.inputStyle]),ie=u(()=>{const s={};return o.containerRole==="combobox"&&(s["aria-haspopup"]=P()["aria-haspopup"],s["aria-owns"]=P()["aria-owns"],s["aria-expanded"]=P()["aria-expanded"]),s});return ye(()=>{!o.formatter&&o.parser&&be(),Se()}),a({input:p,ref:O,focus:S,blur:H,select:W,clear:z}),(s,r)=>ze((v(),k("div",ce(ie.value,{class:Ne.value,style:Pe.value,role:s.containerRole,onMouseenter:r[11]||(r[11]=(...i)=>e(D)&&e(D)(...i)),onMouseleave:r[12]||(r[12]=(...i)=>e(E)&&e(E)(...i))}),[s.$slots.prepend?(v(),k("div",{key:0,class:h(e(f).e("prepend"))},[A(s.$slots,"prepend")],2)):I("",!0),M("div",{class:h([e(l).e("wrapper"),{[e(l).is("focus")]:e(B)}])},[s.$slots.prefix||s.prefixIcon?(v(),k("span",{key:0,class:h(e(l).e("prefix"))},[M("span",{class:h(e(l).e("prefix-inner")),onClick:r[0]||(r[0]=(...i)=>e(S)&&e(S)(...i))},[A(s.$slots,"prefix"),s.prefixIcon?(v(),b(e(T),{key:0,class:h(e(l).e("icon"))},{default:L(()=>[(v(),b(X(s.prefixIcon)))]),_:1},8,["class"])):I("",!0)],2)],2)):I("",!0),M("input",ce({ref_key:"input",ref:p},e(C),{id:e(U),class:e(l).e("inner"),type:s.showPassword?e(R)?"text":"password":s.type,disabled:e(w),formatter:s.formatter,parser:s.parser,readonly:s.readonly,autocomplete:s.autocomplete,tabindex:s.tabindex,"aria-label":s.label,placeholder:s.placeholder,style:s.inputStyle,form:e($),onCompositionstart:r[1]||(r[1]=(...i)=>e(n)&&e(n)(...i)),onCompositionupdate:r[2]||(r[2]=(...i)=>e(y)&&e(y)(...i)),onCompositionend:r[3]||(r[3]=(...i)=>e(q)&&e(q)(...i)),onInput:r[4]||(r[4]=(...i)=>e(ee)&&e(ee)(...i)),onFocus:r[5]||(r[5]=(...i)=>e(ae)&&e(ae)(...i)),onBlur:r[6]||(r[6]=(...i)=>e(te)&&e(te)(...i)),onChange:r[7]||(r[7]=(...i)=>e(ne)&&e(ne)(...i)),onKeydown:r[8]||(r[8]=(...i)=>e(oe)&&e(oe)(...i))}),null,16,ua),ke.value?(v(),k("span",{key:1,class:h(e(l).e("suffix"))},[M("span",{class:h(e(l).e("suffix-inner")),onClick:r[10]||(r[10]=(...i)=>e(S)&&e(S)(...i))},[!J.value||!re.value||!K.value?(v(),k(Ke,{key:0},[A(s.$slots,"suffix"),s.suffixIcon?(v(),b(e(T),{key:0,class:h(e(l).e("icon"))},{default:L(()=>[(v(),b(X(s.suffixIcon)))]),_:1},8,["class"])):I("",!0)],64)):I("",!0),J.value?(v(),b(e(T),{key:1,class:h([e(l).e("icon"),e(l).em("icon","clear")]),onMousedown:r[9]||(r[9]=Ue(()=>{},["prevent"])),onClick:e(z)},{default:L(()=>[Ae(e(Ge))]),_:1},8,["class","onClick"])):I("",!0),re.value?(v(),b(e(T),{key:2,class:h([e(l).e("icon"),e(l).em("icon","password")]),onClick:e(Ce)},{default:L(()=>[e(R)?(v(),b(e(He),{key:0})):(v(),b(e(We),{key:1}))]),_:1},8,["class","onClick"])):I("",!0),K.value?(v(),k("span",{key:3,class:h(e(l).e("count"))},[M("span",{class:h(e(l).e("count-inner"))},ve(e(j))+" / "+ve(e(C).maxlength),3)],2)):I("",!0),F.value&&se.value&&le.value?(v(),b(e(T),{key:4,class:h([e(l).e("icon"),e(l).e("validateIcon"),e(l).is("loading",F.value==="validating")])},{default:L(()=>[(v(),b(X(se.value)))]),_:1},8,["class"])):I("",!0)],2)],2)):I("",!0)],2),s.$slots.append?(v(),k("div",{key:1,class:h(e(f).e("append"))},[A(s.$slots,"append")],2)):I("",!0)],16,ia)),[[De,s.type!=="hidden"]])}}),xa=Me(pa);export{oa as A,ha as C,ba as I,Y as U,Je as a,Ia as b,aa as c,xa as i,Z as o,we as t,Qe as u,ta as x,na as y,ge as z};
