import{b as H,a as te,p as w,q as P,w as se,m as C,u as ae,r as ne,s as oe,t as le,h as re}from"./ResizeObserver.es.5be3fd9e.js";import{d as h,a2 as ue,g as f,o as p,c as x,r as D,n as d,l as i,N as B,e as b,t as E,H as M,w as T,a8 as R,k as q,a9 as A,T as Z,x as U,aq as ie,h as k,j as ce,b as g,I as pe,a1 as de,ae as L,ar as G,aa as z,ac as F}from"./framework.87ef146c.js";import{u as me,a as fe}from"./index.ff3574dd.js";import{p as ye,s as ve,e as ge}from"./message.eda123b1.js";import{j as xe,F as be,E as he}from"./use-global-config.b595be60.js";import{f as V,c as $e}from"./index.1cd28ace.js";const Ce=["default","primary","success","warning","info","danger"],Te=H({value:{type:[String,Number],default:""},max:{type:Number,default:99},isDot:{type:Boolean},hidden:{type:Boolean},type:{type:String,values:Ce,default:"danger"},color:{type:String},text:{type:String},numberStyle:{type:Object}});const Ne=["textContent"],Se=h({name:"TuBadge"}),ke=h({...Se,props:Te,setup(s,{expose:a}){const e=ue(),t=s,n=te("badge"),m=f(()=>({[n.b()]:!0,[n.is("single")]:!e.default&&!t.text,[n.is("status")]:!e.default&&t.text})),r=f(()=>({[n.e("content")]:!0,[n.em("content",t.type)]:t.type,[n.is("fixed")]:e.default,[n.is("dot")]:t.isDot})),u=f(()=>t.isDot?"":w(t.value)&&w(t.max)?t.max<t.value?`${t.max}+`:`${t.value}`:`${t.value}`);return a({content:u}),(o,y)=>(p(),x("div",{class:d(m.value)},[D(o.$slots,"default"),o.color&&!o.$slots.default?(p(),x("span",{key:0,class:d(i(n).em("status","dot")),style:B({background:o.color})},null,6)):b("",!0),o.text?(p(),x("span",{key:1,class:d(i(n).em("status","text"))},E(o.text),3)):b("",!0),M(Z,{name:`${i(P)}-zoom-in-center`},{default:T(()=>[R(q("sup",{textContent:E(u.value),class:d(r.value),style:B(o.numberStyle)},null,14,Ne),[[A,!o.hidden&&(u.value||o.isDot)]])]),_:1},8,["name"])],2))}}),we=se(ke),Be=H({a11y:{type:Boolean,default:!0},locale:{type:C(Object)},size:ae,button:{type:C(Object)},experimentalFeatures:{type:C(Object)},keyboardNavigation:{type:Boolean,default:!0},message:{type:C(Object)},zIndex:Number,namespace:{type:String,default:"tu"}}),I={},Ge=h({name:"TuConfigProvider",props:Be,setup(s,{slots:a}){U(()=>s.message,t=>{Object.assign(I,t??{})},{immediate:!0,deep:!0});const e=xe(s);return()=>D(a,"default",{config:e==null?void 0:e.value})}}),c=ie([]),Ee=s=>{const a=c.findIndex(n=>n.id===s),e=c[a];let t;return a>0&&(t=c[a-1]),{current:e,prev:t}},ze=s=>{const{prev:a}=Ee(s);return a?a.vm.exposed.bottom.value:0},Ie=(s,a)=>c.findIndex(e=>e.id===s)>0?20:a;const De=["id"],Me=["innerHTML"],Oe=h({name:"TuMessage"}),_e=h({...Oe,props:ye,setup(s,{expose:a}){const e=s,{ns:t,zIndex:n}=be("message"),{currentZIndex:m,nextZIndex:r}=n,u=k(),o=k(!1),y=k(0);let N;const K=f(()=>({[t.b()]:!0,[t.m(e.type)]:e.type,[t.is("center")]:e.center,[t.is("closable")]:e.showClose,[e.customClass]:!0})),Q=f(()=>ze(e.id)),O=f(()=>Ie(e.id,e.offset)+Q.value),W=f(()=>y.value+O.value),X=f(()=>({top:`${O.value}px`,zIndex:m.value})),Y=f(()=>e.type?e.type==="error"?"danger":e.type:"info"),$=()=>{o.value=!1},_=()=>{N==null||N()},S=()=>{e.duration!==0&&({stop:N}=ne(()=>{$()},e.duration))},ee=({code:l})=>{l===he.esc&&$()};return ce(()=>{S(),r(),o.value=!0}),U(()=>e.repeatNum,()=>{_(),S()}),me(document,"keydown",ee),fe(u,()=>{y.value=u.value.getBoundingClientRect().height}),a({visible:o,bottom:W,close:$}),(l,j)=>(p(),g(Z,{name:`${i(P)}-fade-in-linear`,onBeforeLeave:l.onClose,onAfterLeave:j[0]||(j[0]=He=>l.$emit("destroy"))},{default:T(()=>[R(q("div",{ref_key:"messageRef",ref:u,role:"alert",id:l.id,class:d(K.value),style:B(X.value),onMouseenter:_,onMouseleave:S},[l.repeatNum>1?(p(),g(i(we),{key:0,value:l.repeatNum,type:Y.value,class:d(i(t).e("badge"))},null,8,["value","type","class"])):b("",!0),l.icon?(p(),g(i(V),{key:1,class:d([i(t).e("icon")])},{default:T(()=>[(p(),g(pe(l.icon)))]),_:1},8,["class"])):b("",!0),D(l.$slots,"default",{},()=>[l.dangerouslyUseHTMLString?(p(),x("span",{key:1,class:d(i(t).e("content")),innerHTML:l.message},null,10,Me)):(p(),x("span",{key:0,class:d(i(t).e("content"))},E(l.message),3))]),l.showClose?(p(),g(i(V),{key:2,class:d(i(t).em("icon","close")),onClick:de($,["stop"])},{default:T(()=>[M(i($e))]),_:1},8,["class","onClick"])):b("",!0)],46,De),[[A,o.value]])]),_:3},8,["name","onBeforeLeave"]))}});let je=1;const J=s=>{const a=!s||L(s)||G(s)||z(s)?{message:s}:s,e={...ge,...a};if(!e.appendTo)e.appendTo=document.body;else if(L(e.appendTo)){let t=document.querySelector(e.appendTo);le(t)||(t=document.body),e.appendTo=t}return e},Le=s=>{const a=c.indexOf(s);if(a===-1)return;c.splice(a,1);const{handler:e}=s;e.close()},Fe=({appendTo:s,...a},e)=>{const t=`message_${je++}`,n=a.onClose,m=document.createElement("div"),r={...a,id:t,onClose:()=>{n==null||n(),Le(y)},onDestroy:()=>{F(null,m)}},u=M(_e,r,z(r.message)||G(r.message)?{default:z(r.message)?r.message:()=>r.message}:null);u.appContext=e||v._context,F(u,m),s.appendChild(m.firstElementChild);const o=u.component,y={id:t,vnode:u,vm:o,handler:{close:()=>{o.exposed.visible.value=!1}},props:u.component.props};return y},v=(s={},a)=>{if(!oe)return{close:()=>{}};if(w(I.max)&&c.length>=I.max)return{close:()=>{}};const e=J(s);if(e.grouping&&c.length){const n=c.find(({vnode:m})=>{var r;return((r=m.props)==null?void 0:r.message)===e.message});if(n)return n.props.repeatNum+=1,n.props.type=e.type,n.handler}const t=Fe(e,a);return c.push(t),t.handler};ve.forEach(s=>{v[s]=(a={},e)=>{const t=J(a);return v({...t,type:s},e)}});function Ve(s){for(const a of c)(!s||s===a.props.type)&&a.handler.close()}v.closeAll=Ve;v._context=null;const Je=re(v,"$message");export{Je as a,we as e,Ge as u};
