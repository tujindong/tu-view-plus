import{b as H,u as te,i as w,d as P,w as se,a as C,c as ae,e as ne,f as oe}from"./ResizeObserver.es.ec0808e4.js";import{d as h,a2 as le,g as f,o as d,c as x,r as D,n as p,l as i,N as B,e as b,t as E,H as M,w as T,a5 as R,k as A,a6 as Z,T as q,x as U,a7 as re,h as k,j as ue,a8 as ie,a9 as ce,b as g,I as de,a1 as pe,aa as me,ab as fe,ac as L,ad as G,ae as z,af as F}from"./framework.207eb8f6.js";import{p as ye,s as ve,e as ge}from"./message.1a64b1c0.js";import{j as xe,F as be,E as he}from"./use-global-config.bb700bba.js";import{f as V,c as $e}from"./index.0f7a71d7.js";const Ce=["default","primary","success","warning","info","danger"],Te=H({value:{type:[String,Number],default:""},max:{type:Number,default:99},isDot:{type:Boolean},hidden:{type:Boolean},type:{type:String,values:Ce,default:"danger"},color:{type:String},text:{type:String},numberStyle:{type:Object}});const Ne=["textContent"],Se=h({name:"TuBadge"}),ke=h({...Se,props:Te,setup(s,{expose:a}){const e=le(),t=s,n=te("badge"),m=f(()=>({[n.b()]:!0,[n.is("single")]:!e.default&&!t.text,[n.is("status")]:!e.default&&t.text})),r=f(()=>({[n.e("content")]:!0,[n.em("content",t.type)]:t.type,[n.is("fixed")]:e.default,[n.is("dot")]:t.isDot})),u=f(()=>t.isDot?"":w(t.value)&&w(t.max)?t.max<t.value?`${t.max}+`:`${t.value}`:`${t.value}`);return a({content:u}),(o,y)=>(d(),x("div",{class:p(m.value)},[D(o.$slots,"default"),o.color&&!o.$slots.default?(d(),x("span",{key:0,class:p(i(n).em("status","dot")),style:B({background:o.color})},null,6)):b("",!0),o.text?(d(),x("span",{key:1,class:p(i(n).em("status","text"))},E(o.text),3)):b("",!0),M(q,{name:`${i(P)}-zoom-in-center`},{default:T(()=>[R(A("sup",{textContent:E(u.value),class:p(r.value),style:B(o.numberStyle)},null,14,Ne),[[Z,!o.hidden&&(u.value||o.isDot)]])]),_:1},8,["name"])],2))}}),we=se(ke),Be=H({a11y:{type:Boolean,default:!0},locale:{type:C(Object)},size:ae,button:{type:C(Object)},experimentalFeatures:{type:C(Object)},keyboardNavigation:{type:Boolean,default:!0},message:{type:C(Object)},zIndex:Number,namespace:{type:String,default:"tu"}}),I={},Ue=h({name:"TuConfigProvider",props:Be,setup(s,{slots:a}){U(()=>s.message,t=>{Object.assign(I,t??{})},{immediate:!0,deep:!0});const e=xe(s);return()=>D(a,"default",{config:e==null?void 0:e.value})}}),c=re([]),Ee=s=>{const a=c.findIndex(n=>n.id===s),e=c[a];let t;return a>0&&(t=c[a-1]),{current:e,prev:t}},ze=s=>{const{prev:a}=Ee(s);return a?a.vm.exposed.bottom.value:0},Ie=(s,a)=>c.findIndex(e=>e.id===s)>0?20:a;const De=["id"],Me=["innerHTML"],Oe=h({name:"TuMessage"}),_e=h({...Oe,props:ye,setup(s,{expose:a}){const e=s,{ns:t,zIndex:n}=be("message"),{currentZIndex:m,nextZIndex:r}=n,u=k(),o=k(!1),y=k(0);let N;const K=f(()=>({[t.b()]:!0,[t.m(e.type)]:e.type,[t.is("center")]:e.center,[t.is("closable")]:e.showClose,[e.customClass]:!0})),Q=f(()=>ze(e.id)),O=f(()=>Ie(e.id,e.offset)+Q.value),W=f(()=>y.value+O.value),X=f(()=>({top:`${O.value}px`,zIndex:m.value})),Y=f(()=>e.type?e.type==="error"?"danger":e.type:"info"),$=()=>{o.value=!1},_=()=>{N==null||N()},S=()=>{e.duration!==0&&({stop:N}=me(()=>{$()},e.duration))},ee=({code:l})=>{l===he.esc&&$()};return ue(()=>{S(),r(),o.value=!0}),U(()=>e.repeatNum,()=>{_(),S()}),ie(document,"keydown",ee),ce(u,()=>{y.value=u.value.getBoundingClientRect().height}),a({visible:o,bottom:W,close:$}),(l,j)=>(d(),g(q,{name:`${i(P)}-fade-in-linear`,onBeforeLeave:l.onClose,onAfterLeave:j[0]||(j[0]=He=>l.$emit("destroy"))},{default:T(()=>[R(A("div",{ref_key:"messageRef",ref:u,role:"alert",id:l.id,class:p(K.value),style:B(X.value),onMouseenter:_,onMouseleave:S},[l.repeatNum>1?(d(),g(i(we),{key:0,value:l.repeatNum,type:Y.value,class:p(i(t).e("badge"))},null,8,["value","type","class"])):b("",!0),l.icon?(d(),g(i(V),{key:1,class:p([i(t).e("icon")])},{default:T(()=>[(d(),g(de(l.icon)))]),_:1},8,["class"])):b("",!0),D(l.$slots,"default",{},()=>[l.dangerouslyUseHTMLString?(d(),x("span",{key:1,class:p(i(t).e("content")),innerHTML:l.message},null,10,Me)):(d(),x("span",{key:0,class:p(i(t).e("content"))},E(l.message),3))]),l.showClose?(d(),g(i(V),{key:2,class:p(i(t).em("icon","close")),onClick:pe($,["stop"])},{default:T(()=>[M(i($e))]),_:1},8,["class"])):b("",!0)],46,De),[[Z,o.value]])]),_:3},8,["name","onBeforeLeave"]))}});let je=1;const J=s=>{const a=!s||L(s)||G(s)||z(s)?{message:s}:s,e={...ge,...a};if(!e.appendTo)e.appendTo=document.body;else if(L(e.appendTo)){let t=document.querySelector(e.appendTo);ne(t)||(t=document.body),e.appendTo=t}return e},Le=s=>{const a=c.indexOf(s);if(a===-1)return;c.splice(a,1);const{handler:e}=s;e.close()},Fe=({appendTo:s,...a},e)=>{const t=`message_${je++}`,n=a.onClose,m=document.createElement("div"),r={...a,id:t,onClose:()=>{n==null||n(),Le(y)},onDestroy:()=>{F(null,m)}},u=M(_e,r,z(r.message)||G(r.message)?{default:z(r.message)?r.message:()=>r.message}:null);u.appContext=e||v._context,F(u,m),s.appendChild(m.firstElementChild);const o=u.component,y={id:t,vnode:u,vm:o,handler:{close:()=>{o.exposed.visible.value=!1}},props:u.component.props};return y},v=(s={},a)=>{if(!fe)return{close:()=>{}};if(w(I.max)&&c.length>=I.max)return{close:()=>{}};const e=J(s);if(e.grouping&&c.length){const n=c.find(({vnode:m})=>{var r;return((r=m.props)==null?void 0:r.message)===e.message});if(n)return n.props.repeatNum+=1,n.props.type=e.type,n.handler}const t=Fe(e,a);return c.push(t),t.handler};ve.forEach(s=>{v[s]=(a={},e)=>{const t=J(a);return v({...t,type:s},e)}});function Ve(s){for(const a of c)(!s||s===a.props.type)&&a.handler.close()}v.closeAll=Ve;v._context=null;const Ge=oe(v,"$message");export{Ge as a,we as e,Ue as u};
